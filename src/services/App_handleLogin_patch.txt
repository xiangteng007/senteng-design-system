// App.jsx 修正：確保 login 的 popup 在 user gesture 內觸發
// 找到 App.jsx 的 handleLogin，用這一段整段覆蓋：

const handleLogin = () => {
  // 不要先 setLoading(true) 再 await，避免某些瀏覽器把 popup 判定為非使用者手勢
  GoogleService.login()
    .then(async (user) => {
      setSignedIn(true);
      addToast("Google 登入成功。", "success");
      await loadAllData();
    })
    .catch((err) => {
      console.error("[App] handleLogin error:", err);
      addToast("登入失敗：請確認已允許彈出視窗 / 關閉擋廣告外掛後再試。", "error");
    })
    .finally(() => {
      setLoading(false);
    });

  setLoading(true);
};
